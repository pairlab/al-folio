import{highlightSearchTerm}from"./highlight-search-term.js";document.addEventListener("DOMContentLoaded",(function(){const e=e=>{if(document.querySelectorAll(".bibliography, .unloaded").forEach((e=>e.classList.remove("unloaded"))),CSS.highlights){const t=highlightSearchTerm({search:e,selector:".bibliography > li"});if(null==t)return;t.forEach((e=>{e.classList.add("unloaded")}))}else document.querySelectorAll(".bibliography > li").forEach((t=>{const n=t.innerText.toLowerCase(),l=(t.getAttribute("data-keywords")||"").toLowerCase(),o=(t.getAttribute("data-tags")||"").toLowerCase();-1==n.indexOf(e)&&-1==l.indexOf(e)&&-1===o.indexOf(e)&&t.classList.add("unloaded")}));document.querySelectorAll("h2.bibliography").forEach((function(e){let t=e.nextElementSibling,n=!0;for(;t&&"H2"!==t.tagName;){if("OL"===t.tagName){const e=t,l=e.querySelectorAll(":scope > li.unloaded"),o=e.querySelectorAll(":scope > li");l.length===o.length?(e.previousElementSibling.classList.add("unloaded"),e.classList.add("unloaded")):n=!1}t=t.nextElementSibling}n&&e.classList.add("unloaded")}))},t=()=>{const t=decodeURIComponent(window.location.hash.substring(1));document.getElementById("bibsearch").value=t,e(t)};let n;document.getElementById("bibsearch").addEventListener("input",(function(){clearTimeout(n);const t=this.value.toLowerCase();n=setTimeout(e(t),300)})),window.addEventListener("hashchange",t),t()})),document.addEventListener("DOMContentLoaded",(function(){let e=null;document.querySelectorAll(".tag-filter").forEach((function(t){t.addEventListener("click",(function(){const n=t.getAttribute("data-tag").toLowerCase(),l=document.getElementById("bibsearch");l&&(e===n?(l.value="",e=null,document.querySelectorAll(".tag-filter").forEach((e=>e.classList.remove("active")))):(l.value=n,e=n,document.querySelectorAll(".tag-filter").forEach((e=>e.classList.remove("active"))),t.classList.add("active")),l.dispatchEvent(new Event("input")))}))}))}));